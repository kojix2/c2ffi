FROM ubuntu:23.04
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt-get install -y llvm-15 clang-15 libclang-15-dev libclang-cpp15-dev cmake

# Copy the source into the Docker container
RUN mkdir -p /c2ffi
COPY ../ /c2ffi
WORKDIR /c2ffi

# Build c2ffi
ENV CXX /usr/bin/clang++-15
RUN mkdir -p build && cd build && cmake -DBUILD_CONFIG=Release .. && make

CMD /c2ffi/build/bin/c2ffi
